var GetPrice=GetPrice||{};GetPrice.priceDOM=new Array();GetPrice.getPriceFlag=false;GetPrice.cityLESId="";GetPrice.districtLESId="";GetPrice.channel="";GetPrice.callback="";GetPrice.queryprice=function(h,j,n){GetPrice.priceDOM=h;GetPrice.channel=j;GetPrice.callback=n;if(GetPrice.cityLESId==""){GetPrice.cityInf(GetPrice.cityInfCallback)}else{var g=h[0];var p=h.length>20?20:h.length;var a="";var b="";var l="";for(var f=0;f<p;f++){var e=[];if(typeof(h[f].attr("data-sku"))=="undefined"){e=h[f].attr("lazy-sku").split("|")}else{e=h[f].attr("data-sku").split("|")}var m=e[0];var o="";var c="1";if(e[2]=="2"){o=e[3];c="2"}else{if(e[2]=="3"){o="0000000000";c="2"}}if(m.length==18){a+=m}if(m.length<18){var k=GetPrice.addPreZero(m,18);a+=k}b+=o;l+=c;if(f!=p-1){a+=",";b+=","}}$.ajax({url:sn.icpsDomain+"/icps-web/getVarnishAllPrice014/"+a+"_"+GetPrice.cityLESId+"_"+GetPrice.districtLESId+"_"+b+"_"+j+"_pricecallback.vhtm",cache:true,dataType:"jsonp",jsonp:false,jsonpCallback:"pricecallback",timeout:3000,error:function(i,r,q){},success:function(i){n(i)}})}};GetPrice.addPreZero=function(e,f){var b=(e+"").length,c="";for(var a=0;a<f-b;a++){c+="0"}return c+e};GetPrice.cityInf=function(c){var g=d("SN_CITY");if(g&&compareMDMIdAndLesId(g)){var f=analyzeCookie(g);if(typeof c=="function"){c(f)}}else{var e=/^(\w*)(pre)(\w*)(.cnsuning.com)$/;var h=/^(\w*)(sit)(\w*)(.cnsuning.com)$/;var i=/^(\w*)(dev)(\w*)(.cnsuning.com)$/;var b=document.location.hostname;var j="http://ipservice.suning.com";if(e.test(b)){j="http://ipservicepre.cnsuning.com"}else{if(h.test(b)){j="http://ipservicesit.cnsuning.com"}else{if(i.test(b)){j="http://ipservicesit.cnsuning.com"}}}var a=j+"/ipQuery.do";$.ajax({type:"GET",url:a,cache:true,async:false,dataType:"jsonp",jsonpCallback:"cookieCallback",success:function(k){k.flag="2";k.count=0;if(typeof c=="function"){c(k)}},error:function(){if(typeof c=="function"){c("")}}})}};var cookieCallback=function(a){};var compareMDMIdAndLesId=function(c){var a=c.split("|");if(a.length>0){var b=a[0].split("_");if(b[0]==b[1]){return false}else{return true}}};var analyzeCookie=function(e){var b=e.split("|");var a=null;if(b.length>0){var c=b[0].split("_");a={};a.provinceMDMId=c[0];a.cityLESId=c[1];a.cityMDMId=c[2];a.cityCommerceId=c[3];a.districtLESId=c[4];a.districtCommerceId=c[5];a.flag=c[6];a.count=c[7]}return a};var pricecallback=function(a){};GetPrice.cityInfCallback=function(a){sn.cityId="9017";GetPrice.cityLESId="010";GetPrice.cityLESId="0100101";if(null!=a&&""!=a){GetPrice.cityLESId=a.cityLESId;GetPrice.districtLESId=a.cityLESId+a.districtLESId+"01";sn.cityId=a.cityCommerceId}GetPrice.queryprice(GetPrice.priceDOM,GetPrice.channel,GetPrice.callback)};var supermarket1=supermarket1||{};supermarket1.priceDOM=[];supermarket1.getPriceFlag=false;supermarket1.switchPriceFlag="";supermarket1.getPrice=function(){supermarket1.getPriceFlag=true;GetPrice.queryprice(supermarket1.priceDOM,"1",supermarket1.getpricecallback)};supermarket1.getpricecallback=function(e){for(var f=0;f<e.length;f++){if(e[f]){var h="";var l="";var b="";var d="";if(e[f].price){h=e[f].price}if(e[f].invStatus){b=e[f].invStatus}if(e[f].status){d=e[f].status}if(!h){var k=supermarket1.priceDOM[0].find(".curPrice").parent();if(k.hasClass("commodity-conprice")||k.hasClass("price-small-box")){supermarket1.priceDOM[0].find(".curPrice").html("<span>暂无报价</span>")}else{supermarket1.priceDOM[0].find(".curPrice").html('<span class="tempor-price">暂无报价</span>')}}else{if(e[f].refPrice){l=e[f].refPrice}else{if(e[f].snPrice){l=e[f].snPrice}else{l=e[f].price}}var n=l;var m=l.split(".");if(m.length>0){n=m[0]}var j="";var g=h.split(".");if(g.length>0){j=g[0]}var k=supermarket1.priceDOM[0].find(".curPrice").parent();if(k.hasClass("price-small-box")){supermarket1.priceDOM[0].find(".curPrice").html("<b>&yen;</b>"+j)}else{supermarket1.priceDOM[0].find(".curPrice").html("<span>&yen;"+j+"</span>")}if(h&&l){var k=supermarket1.priceDOM[0].find(".curPrice").parent();if(k.hasClass("price-small-box")){var a=supermarket1.priceDOM[0].find(".refPrice").html();if(!a){var c=parseInt(n)-parseInt(j);if(parseInt(c)>0){supermarket1.priceDOM[0].find(".refPrice").html('<div class="low-price">降'+c+"</div><i>&yen;"+n+"</i>")}else{supermarket1.priceDOM[0].find(".refPrice").html("<i>&yen;"+n+"</i>")}}}}}if(b!=1||d!=1){var k=supermarket1.priceDOM[0].find(".curPrice").parent().parent().parent();k.find(".secImg").find("img").before("<b class='loot-all'></b>")}}else{var k=supermarket1.priceDOM[0].find(".curPrice").parent();if(k.hasClass("commodity-conprice")||k.hasClass("price-small-box")){supermarket1.priceDOM[0].find(".curPrice").html("<span>暂无报价</span>")}else{supermarket1.priceDOM[0].find(".curPrice").html('<span class="tempor-price">暂无报价</span>')}}supermarket1.priceDOM.shift()}if(supermarket1.priceDOM.length>0){GetPrice.queryprice(supermarket1.priceDOM,"1",supermarket1.getpricecallback)}else{supermarket1.getPriceFlag=false}};$(function(){lazyelem.listen("li[data-sku]","fn",function(a){supermarket1.priceDOM.push(a);if(supermarket1.getPriceFlag){return}supermarket1.getPrice()});lazyelem.listen("dl[data-sku]","fn",function(a){supermarket1.priceDOM.push(a);if(supermarket1.getPriceFlag){return}supermarket1.getPrice()})});