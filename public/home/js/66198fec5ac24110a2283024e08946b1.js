var loginCallbackStack=[];var intervalVar;var currentLocation;var wapPopSt=1;var isAppendLoginStyle=false;function popupLoginContainer(a){if(typeof a=="undefined"){if(typeof passport_config!="undefined"){a=passport_config}else{alert("You must define passport_config var.");return}}currentLocation=window.location.href;var b=((typeof a.successCallbackUrl=="undefined")?(a.base+"popupLoginSuccess?"):a.successCallbackUrl)+"topLocation="+encodeURIComponent(currentLocation.split("#")[0])+"&loginTheme="+a.loginTheme;$modalOverlay=$("#modalOverlay");if($modalOverlay.length>0){$modalOverlay.remove()}$modalContainer=$("#modalContainer");if($modalContainer.length>0){$modalContainer.remove()}$("body").append('<div id="modalOverlay" style="opacity: 0.3;filter:Alpha(opacity=30);background:none repeat scroll 0 0 #000000;position: absolute;border: 0 none;width: 100%;height: 100%;top: 0;left: 0;z-index:1000097;"></div><div id="modalContainer" style="z-index:1000098;position:fixed;_position: absolute;"></div>');$("#modalOverlay").hide();$("#modalOverlay").css("height",$(document).height()+"px");$("#modalContainer").html('<iframe id="iframeLogin" style="position: fixed ;" width="1" height="1" src="'+b+'" frameborder="0" scrolling="no" allowtransparency="yes"></iframe>');if(typeof intervalVar!="undefined"){clearInterval(intervalVar)}intervalVar=window.setInterval(checkMsgFromLoginIframe,200)}function checkMsgFromLoginIframe(){var a=window.location.hash;if(a.length>1){var b=a.split("#");var c=b[1].split(":");switch(c[0]){case"resize":resizeContainer(c[1]);break;case"close":closeContainer();break;case"loginSuccess":loginSuccess();break;case"loginRedirect":location.href=decodeURIComponent(c[1]);break;default:break}}}var ie6_num=0;function resizeContainer(g){$("#modalOverlay").show();var h=g.split(",");var b=h[0];var i=h[1];$iframe=$("#iframeLogin");$iframe.attr("width",b);$iframe.attr("height",i);var d=window.innerWidth?window.innerWidth:$(window).width();var a=window.innerHeight?window.innerHeight:$(window).height();var c=(d-b)/2;var f=(a-i)/2;var e=$(document).scrollTop();$modalContainer=$("#modalContainer");$modalContainer.css("top",Math.max(f,5));if(!window.XMLHttpRequest){ie6_num=1;f=f+e;$modalContainer.css("top",Math.max(f,5))}$modalContainer.css("left",c)}function closeContainer(){document.getElementById("modalOverlay").style.display="none";document.getElementById("modalContainer").style.display="none";$("html").removeClass("login-noscroll2");$("body").removeClass("login-noscroll");if(wapPopSt!=1){$("body").scrollTop(wapPopSt);wapPopSt=1}window.location.href=(currentLocation.indexOf("#")==-1)?currentLocation+"#unknown":currentLocation;clearInterval(intervalVar)}function loginSuccess(){closeContainer();var a=loginCallbackStack.pop();if(a!=null){a()}}function probeAuthStatus(c,b,a){if(typeof a=="undefined"){if(typeof passport_config!="undefined"){a=passport_config}else{alert("You must define passport_config var.");return}}$.ajax({url:a.base+"authStatus",crossDomain:true,cache:false,dataType:"jsonp",success:function(d){if(d.hasLogin){var e=d.principal;c(e)}else{b()}}})}function ensureLogin(b,a){if(typeof a=="undefined"){if(typeof passport_config!="undefined"){a=passport_config}else{alert("You must define passport_config var.");return}}loginCallbackStack.push(b);popupLoginContainer(a)}function ensureLoginWap(c,a){if(typeof a=="undefined"){if(typeof passport_config!="undefined"){a=passport_config}else{alert("You must define passport_config var.");return}}loginCallbackStack.push(c);currentLocation=window.location.href;var b=((typeof a.successCallbackUrl=="undefined")?(a.base+"popupLoginSuccess?"):a.successCallbackUrl)+"topLocation="+encodeURIComponent(currentLocation.split("#")[0])+"&loginTheme="+a.loginTheme;$modalOverlay=$("#modalOverlay");if($modalOverlay.length>0){$modalOverlay.remove()}$modalContainer=$("#modalContainer");if($modalContainer.length>0){$modalContainer.remove()}$("body").append('<div id="modalOverlay" style="position: absolute; top: 0; left: 0; z-index: 998;"></div><div id="modalContainer"></div>');$("#modalOverlay").height("100%").width("100%");$("#modalOverlay").html('<iframe id="iframeLogin"  src="'+b+'" width="100%" height="100%" scrolling="no" frameborder="0"></iframe>');if(!isAppendLoginStyle){$("head").append("<style>.login-noscroll{overflow:hidden;height:100%} .login-noscroll2{overflow:scroll;height:100%}</style>");isAppendLoginStyle=true}wapPopSt=$("body").scrollTop();$("html").addClass("login-noscroll2");$("body").addClass("login-noscroll");if(typeof intervalVar!="undefined"){clearInterval(intervalVar)}$("#iframeLogin").on("load",function(){intervalVar=window.setInterval(checkMsgFromLoginIframe,200)})}function ajaxInSameDomain(c,e,f,d,b,a){if(typeof a=="undefined"){if(typeof passport_config!="undefined"){a=passport_config}else{alert("You must define passport_config var.");return}}$.ajax({url:c,data:e,type:f,cache:false,error:b,success:function(g){if(g.idsIntercepted){var i=function(){ajaxInSameDomain(c,e,f,d,b,a)};if(g.policy=="GATEWAY"&&g.status=="UNKNOWN"){probeAuthStatus(i,i,a);return}if(g.policy="RESTRICTED"){if(g.status=="ANONYMOUS"){loginCallbackStack.push(i);popupLoginContainer(a);return}else{if(g.status=="UNKNOWN"){var h=function(){loginCallbackStack.push(i);popupLoginContainer(a)};probeAuthStatus(i,h,a);return}}}console.log("Illegal status.");return}d(g)}})}function ajaxCrossDomain(c,e,d,b,a){if(typeof a=="undefined"){if(typeof passport_config!="undefined"){a=passport_config}else{alert("You must define passport_config var.");return}}$.ajax({url:c,data:e==null?"crossDomainJsonpRequest=true":e+"&crossDomainJsonpRequest=true",crossDomain:true,dataType:"jsonp",cache:false,error:b,success:function(f){if(f.authStatusResponse){var g=function(){ajaxCrossDomain(c,e,d,b,a)};if(f.hasLogin){g()}else{loginCallbackStack.push(g);popupLoginContainer(a)}return}d(f)}})}if(!window.XMLHttpRequest){$(window).scroll(function(){var a=$(document).scrollTop();var b=$(window).height();var c=$("#modalContainer").find("iframe").height();var d=Math.max(0,(b-c)/2);$("#modalContainer").css({top:a+d})})}function ensureReg(b,a){probeAuthStatus(function(){if(b!=null){b()}},function(){popupRegContainer(b,a)},a)}function popupRegContainer(c,a){if(typeof a=="undefined"||a==null){if(typeof passport_config!="undefined"){a=passport_config}else{alert("You must define passport_config var.");return}}if(!a.hasOwnProperty("regDomain")){alert("You must define passport_config.regDomain");return}loginCallbackStack.push(c);currentLocation=window.location.href;var b=a.regDomain+"/popreg.do?topLocation="+encodeURIComponent(currentLocation.split("#")[0]);$modalOverlay=$("#modalOverlay");if($modalOverlay.length>0){$modalOverlay.remove()}$modalContainer=$("#modalContainer");if($modalContainer.length>0){$modalContainer.remove()}$("body").append('<div id="modalOverlay" style="opacity: 0.3;filter:Alpha(opacity=30);background:none repeat scroll 0 0 #000000;position: absolute;border: 0 none;width: 100%;height: 100%;top: 0;left: 0;z-index:1000097;"></div><div id="modalContainer" style="z-index:1000098;position:fixed;_position: absolute;"></div>');$("#modalOverlay").hide();$("#modalOverlay").css("height",$(document).height()+"px");$("#modalContainer").html('<iframe id="iframeLogin" style="position: fixed ;" width="412" height="1" src="'+b+'" frameborder="0" scrolling="no" allowtransparency="yes"></iframe>');if(typeof intervalVar!="undefined"){clearInterval(intervalVar)}intervalVar=window.setInterval(checkMsgFromLoginIframe,200)};var aqSuning1=aqSuning1||{};var aqjs1=document.getElementsByTagName("script");var aqcss1=document.getElementsByTagName("link");aqSuning1.aqIntervalVar=null,aqSuning1.aqPasportUrl=null,aqSuning1.ascUrl=null,aqSuning1.aqRefreshFlag=false,aqSuning1.aqCallback=null,aqSuning1.aqSuccessFlag="false";function isInclude(e,f){if(f){for(var d=0;d<aqjs1.length;d++){if(aqjs1[d][f?"src":"href"].indexOf(e)!=-1){return true}}return false}else{for(var d=0;d<aqcss1.length;d++){if(aqcss1[d][f?"src":"href"].indexOf(e)!=-1){return true}}return false}}function getCurVersion(){var b=new Date();var a=b.getYear()+"-"+b.getMonth()+"-"+b.getDate()+":"+b.getHours();return a}$(document).ready(function(){var g=document.location.hostname;aqSuning1.aqPasportUrl="https://passport.suning.com/ids/";aqSuning1.ascUrl="https://aq.suning.com/asc/";if(!isInclude("jquery",true)){alert("请引入jQuery.js")}if(!isInclude("passport",true)){var h="PROD",i=null;if("DEV"==h){i='<script>var passport_config = { base: "${asc.project.authstatus.url.prefix}",loginTheme: "b2c_pop"};<\/script>'}else{i="<script>var passport_config = { base: '"+aqSuning1.ascUrl+"',loginTheme: 'b2c_pop'};<\/script>"}$("title").after(i);var f=document.createElement("script");var e=getCurVersion();f.src=aqSuning1.aqPasportUrl+"js/passport.js?V="+e;f.type="text/javascript";var d=document.getElementsByTagName("head")[0];d.appendChild(f)}});aqSuning1.showMobilePopType=function(a,b){probeAuthStatus(function(){aqSuning1.aqRefreshFlag=a;aqSuning1.aqCallback=b;securityBindPhone()},function(){ensureLogin(function(){aqSuning1.showMobilePopType(a,b)})})};var securityBindPhone=function(){var e=window.location.href;var g=aqSuning1.ascUrl+"popout/showBoxType.do?topLocation="+encodeURIComponent(e.split("#")[0])+"#success";var i="<div class='mask-layer'></div>",h='<iframe id="security-bind-phone" frameborder=0 allowTransparency="true" src='+g+' style="position:fixed;top:50%;left:50%;margin-top:-300px;margin-left:-231px;width:462px;height:600px;border:none;background: transparent;z-index:9995;_position:absolute;"></iframe>',a="",c="",k="",f="",b="",l="";function j(){a=document.body.clientWidth,c=document.body.clientHeight,k=window.screen.availWidth,f=window.screen.availHeight;if(c>f){b=a;l=c}else{b=k;l=f}}j();$(i).appendTo($("body")).css({position:"absolute",top:0,left:0,width:b,height:l,background:"#000",opacity:0,zIndex:9990}).stop().animate({opacity:0.3});$(h).appendTo($("body")).css({opacity:0}).stop().animate({opacity:1});$(window).resize(function(){j();$(i).css({width:b,height:l})});if((navigator.userAgent.indexOf("MSIE 6.0")>0)){$(window).scroll(function(){j();$(i).css({width:b,height:l});var m=$(window).scrollTop(),d=$(window).height()/2;$("#security-bind-phone").css({top:m+d})})}else{$(window).scroll(function(){j();$(i).css({width:b,height:l})})}aqSuning1.aqIntervalVar=window.setInterval(checkMsgFromBindPhoneIframe,200)};function checkMsgFromBindPhoneIframe(){var a=window.location.hash;if(a.length>1){var b=a.split("#");var c=b[1].split(":");switch(c[0]){case"close":securityBindPhoneClose();break;case"bindSuccess":securityBindPhoneClose();break;default:break}}}var securityBindPhoneClose=function(){var f=$("#security-bind-phone"),g=f.siblings(".mask-layer");f.stop().animate({opacity:0},function(){f.remove()});g.stop().animate({opacity:0},function(){g.remove()});clearInterval(aqSuning1.aqIntervalVar);var e=window.location.href;var b=e.indexOf("#");var d=e.substring(0,b)+"#unknown:";window.location.href=d;var c=e.indexOf(":?");if(c>-1){aqSuning1.aqSuccessFlag=e.substring(c).split("=")[1]}if(aqSuning1.aqRefreshFlag==true){window.location.reload()}var h=(aqSuning1.aqCallback!=undefined&&aqSuning1.aqCallback!=null);if(aqSuning1.aqSuccessFlag=="true"&&h){aqSuning1.aqCallback(true)}else{if(h){aqSuning1.aqCallback(false)}}};